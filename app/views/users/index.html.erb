<% if user_signed_in? %>

  <% if !@all_posts.nil? %>
    <h2>All Posts</h2>
    <div id="posts-outer">
      <% @all_posts.each do |post| %>
        <div class="panel panel-info">
          <div class="panel-heading">
            <h3 class="panel-title">
              <%= post.title %>
              <span style="float: right;"><%= post.user.email %> | <%= post.updated_at.strftime("%b %d, %Y (%l:%M %P)") %></span>
            </h3>
          </div>
          <div class="panel-body">
            <%= post.body %>
            <span style="float: right;"><%= link_to "Delete", [post.user, post], method: :delete, class: 'btn btn-default' %></span>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>

  <br>
  <hr>

  <h2>Post your status!</h2>
  <br>

  <%= form_for([@user, @post]) do |f| %>
    <% if @post.errors.any? %>
      <div class="errors-div">
        <h4 class="errors-colors">
          I'm sorry, your post couldn't be saved because:
        </h4>
        <ul>
          <% @post.errors.messages.each do |field, error| %>
            <li class="errors-colors"><%= "#{field.to_s.capitalize} #{error[0]}" %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <h4><%= f.label :title %></h4>
    <%= f.text_field :title, cols: 50 %><br>

    <h4><%= f.label :body %></h4>
    <%= f.text_area :body, cols: 50, rows: 5 %><br>

    <%= f.submit 'Post' %>
  <% end %>

<!--If user is not signed in-->
<% else %>
  <p>Sign in to post a status update!</p>
<% end %>
